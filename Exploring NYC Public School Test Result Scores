# Re-run this cell 
import pandas as pd

# Read in the data
schools = pd.read_csv("schools.csv")

# Preview the data
schools.head()

# Schools with a minimum average of 80% on math results
desired_average = schools[schools["average_math"] >= 640]
math_schools = schools[schools["school_name"].isin(desired_average["school_name"])].sort_values(by="average_math", ascending=False)
best_math_schools = math_schools.loc[:, ["school_name", "average_math"]]
print(best_math_schools)

# Top 10 schools
schools["total_SAT"] = schools["average_math"] + schools["average_reading"] + schools["average_writing"]
top_10_subset = schools.groupby("school_name").mean().reset_index()
top_10_schools = top_10_subset.sort_values(by="total_SAT", ascending=False).loc[:, ["school_name", "total_SAT"]].head(10)
print(top_10_schools)

# NYC's borough with the largest standard deviation for "total_SAT"
boroughs = schools.groupby("borough")["total_SAT"].agg(["count", "mean", "std"]).round(2)
largest_std_dev = boroughs[boroughs["std"] == boroughs["std"].max()]
largest_std_dev.columns= ["num_schools", "average_SAT", "std_SAT"]
largest_std_dev = largest_std_dev.round(2)
print(largest_std_dev)
